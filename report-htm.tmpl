<!doctype html>
<html>
<head><title>sample-report-v2</title>
<style media="all">
body {font-family: Arial, sans-serif;}
h1,h2,h3,h4,h5,h6 { font-family: Helvetica, Arial, sans-serif; }
h1 {color: #17365d;font-weight: normal}
h2 {color: #345a8a;}
h3 {color: #4f81bd;}

/** Couchbase sepcific styles **/
.status-error {background: #f00;color:#fff;}
.status-warning {background: #ff0;}
.status-ok {background: #0f0;}
</style>
<style media="print">
/* --------------------------------------------------------------
Based on Hartija & Priss CSS Print  Frameworks
-------------------------------------------------------------- */

body {
width:100% !important;
margin:0 !important;
padding:0 !important;
line-height: 1.4;
word-spacing:1.1pt;
letter-spacing:0.2pt;
color: #000;
background: none;
font-size: 12pt;
}

/*Headings */
h1{font-size:19pt;}
h2{font-size:17pt;}
h3{font-size:15pt;}
h4,h5,h6{font-size:12pt;}

code { font: 10pt Courier, monospace; }
blockquote { margin: 1.3em; padding: 1em;  font-size: 10pt; }
hr { background-color: #ccc; }

/* Images */
img { float: left; margin: 1em 1.5em 1.5em 0; }
a img { border: none; }

/* Links */
a:link, a:visited { background: transparent; font-weight: 700; text-decoration: underline;color:#333; }
a:link[href^="http://"]:after, a[href^="http://"]:visited:after { content: " (" attr(href) ") "; font-size: 90%; }
a[href^="http://"] {color:#000; }

/* Table */
table { border-collapse: collapse; margin: 1px; text-align:left; page-break-inside: avoid;}
th { border: 1px solid #333;  font-weight: bold; }
td { border: 1px solid #333; }
th,td { padding: 4px 10px 4px 10px; }
tfoot { font-style: italic; }
caption { background: #fff; margin-bottom:2em; text-align:left; }
thead {display: table-header-group;}
tr {page-break-inside: avoid;}

article {page-break-after: always}
</style>
<style type="text/css" media="screen">

body {margin:10%;padding:0;font:16px 'Arial';}

#page {position:relative; overflow: hidden;}

h1 {padding-left: 2px;margin-top: 0px;margin-bottom: 0px;font: 25px 'Arial';line-height: 30px;}
h2 {font: bold 21px 'Arial';line-height: 24px;}
h3 {font: bold 17px 'Arial';line-height: 19px;}
ul {line-height:28px}
ul ul {list-style: none}
table td {padding:7px}

.ft1{font: italic 19px 'Arial';color: #345a8a;line-height: 15px;}
.ft6{white-space: nowrap;}
.ft8{font-weight: bold;line-height: 19px;white-space: nowrap;}
.ft9{font: 15px 'Arial';line-height: 17px;white-space: nowrap;}
.ft15{font-weight: bold;line-height: 17px;white-space: nowrap;}
.ft16{font: 16px 'Symbol';line-height: 29px;}
.ft17{line-height: 27px;}
.ft31{background-color:#FFFF00}
.ft32{background-color:#00FF00}

.p0{padding-left: 2px;margin-top: 0px;margin-bottom: 0px;}
.p1{padding-left: 2px;margin-top: 40px;margin-bottom: 0px;}
.p2{padding-left: 2px;margin-top: 3px;margin-bottom: 0px;}
.p3{padding-left: 2px;margin-top: 35px;margin-bottom: 0px;}
.p4{padding-left: 2px;margin-top: 34px;margin-bottom: 0px;}
.p8{padding-left: 74px;padding-right: 306px;margin-top: 0px;margin-bottom: 0px;text-indent: -47px;}
.p10{margin-top: 0px;margin-bottom: 0px;}
.p11{margin-top: 35px;margin-bottom: 0px;}
.p12{margin-top: 38px;margin-bottom: 0px;}
.p13{margin-top: 30px;margin-bottom: 0px;}
.p14{margin-top: 34px;margin-bottom: 0px;}

.td0{text-align: left;padding-left: 0px;}
.td1{text-align: left;padding-left: 9px;}
.td2{text-align: left;padding-left: 2px;}
.td3{text-align: left;padding-left: 57px;}
.td4{text-align: left;padding-left: 0px;}
.td5, .td6, .td7, .td8, .td9, .td10, .td11, .td12, .tdr, .tdy{border: 1pt solid black;text-align: left;padding-left: 7px;}
.td18{border-right: #000000 1pt solid;text-align: left;padding-left: 0px;}

.t0, .t1, .t3{border-collapse: collapse;}
.t0{margin-left: 26px;margin-top: 5px;font: 13px 'Symbol';line-height: 16px;}
.t1{margin-left: 26px;margin-top: 51px;}

</style>
</head>

<body>
<div id="page">

<h1>Couchbase Cluster Health Check Report</h1>
<p class="p1"><span class="ft1">Tool Version: $globals['versions']</span></p>
<p class="p0"><span class="ft1">Execution Time: $globals['report_time'].strftime("%Y-%m-%d %H:%M:%S")</span></p>
#if $globals.cluster_health == "Error"
<p class="p2"><strong>Overall cluster health: </strong><span class="status-error">Immediate action needed</span></p>
#elif $globals.cluster_health == "Warning"
<p class="p2"><sstrong>Overall cluster health: </strong><span class="status-warning">Attention needed</span></p>
#else
<p class="p2"><strong>Overall cluster health: </strong><span class="status-ok">OK</span></p>
#end if
#if $indicator_error_exist
<article>
<h2>Couchbase &#8211; Alerts</h2>
<h3>Cluster-wide metrics</h3>
#for $counter in sorted($indicator_error.keys())
#set $error_list = $indicator_error[$counter]
#for $error_values in $error_list:
<p class="p20"><span class="ft3">$error_values["description"]</span></p>
<ul>
	<li>Symptom
#for $err_val in sorted($error_values["value"])
    <ul>
      <li>Bucket : $error_values["bucket"] , Node : $err_val["node"]</li>
      <li>Value : $err_val["value"]</li>
    </ul>
#end for
  </li>
  <li>Causes - $error_values["cause"]</li>
  <li>Impact - $error_values["impact"]</li>
	<li>Action - $error_values["action"]</li>
</ul>
#end for
#end for
</article>
#end if
<article>
<h2>Couchbase Cluster Overview</h2>
<h3>Node list</h3>
<table class="t1">
<tr class="tr6">
	<td class="td5"><span class="ft15">Node IP</span></td>
	<td class="td6"><span class="ft15">Couchbase Server Version</span></td>
	<td class="td7"><span class="ft15">Status</span></td>
</tr>
#for $node in sorted($node_list["nodeList"]["value"])
<tr class="tr6">
	<td class="td8">$node["host"]</td>
	<td class="td9">$node["version"]</td>
	<td class="td10">$node["status"]</td>
</tr>
#end for
</table>
<ul>
  <li>Total number of nodes in the cluster: $node_list["numNodes"]["value"]</li>
  <li>Number of down nodes: $node_list["numDownNodes"]["value"]</li>
  <li>Number of warming up nodes: $node_list["numWarmupNodes"]["value"]</li>
</ul>
<h3>Cluster-wide metrics</h3>
<table class="t1">
#for $key in sorted($cluster_symptoms.keys())
#set $value = $cluster_symptoms[$key]
<tr class="tr4">
	<td class="td11">$value["description"]</td>
	<td class="td12">$value["value"]</td>
</tr>
#end for
</table>
<h3>Bucket metrics</h3>
#for $bucket in sorted($bucket_list.keys())
#set $status = $bucket_list[$bucket]
<p class="p2"><strong>Bucket name: </strong><span class="ft3">$bucket</span></p>
#if $status == "Error"
<p class="p10"><strong>Status &#8211; </strong><span class="status-error">Immediate action needed</span></p>
#elif $status == "Warning"
<p class="p10"><strong>Status &#8211; </strong><span class="status-warning">Attention needed</span></p>
#else
<p class="p10"><strong>Status &#8211; </strong><span class="status-ok">OK</span></p>
#end if
<table class="t3">
#for $symptom in sorted($bucket_symptoms[$bucket])
<tr class="tr6">
	<td class="td11">$symptom["description"]</td>
#if $symptom["status"] == "Error"
	<td class="tdr status-error">$symptom["value"]</td>
#elif $symptom["status"] == "Warning"
	<td class="tdy status-warning">$symptom["value"]</td>
#else
	<td class="td12">$symptom["value"]</td>
#end if
</tr>
#end for
</table>
#if $verbose
#for $node in sorted($bucket_node_symptoms[$bucket])
#set $node_values = $bucket_node_symptoms[$bucket][$node]
<p class="p12"><strong>IP address: $node</strong></p>
#if $bucket_node_status[$bucket].has_key($node)
#if $bucket_node_status[$bucket][$node] == "Error"
<p class="p10"><strong>Status &#8211; </strong><span class="status-error">Immediate action needed</span></p>
#elif $bucket_node_status[$bucket][$node] == "Warning"
<p class="p10"><strong>Status &#8211; </strong><span class="status-warning">Attention needed</span></p>
#else
<p class="p10"><strong>Status &#8211; </strong><span class="status-ok">OK</span></p>
#end if
#else
<p class="p10"><strong>Status &#8211; </strong><span class="status-ok">OK</span></p>
#end if
<table class="t3">
#for $node_value in sorted($node_values)
<tr class="tr6">
	<td class="td11">$node_value["description"]</td>
#if $node_value["status"] == "Error"
	<td class="tdr status-error">$node_value["value"]</td>
#elif $node_value["status"] == "Warning"
	<td class="tdy status-warning">$node_value["value"]</td>
#else
	<td class="td12">$node_value["value"]</td>
#end if
</tr>
#end for
</table>
#end for
#end if
#end for
</article>
#if $indicator_warn_exist
<article>
<h2>Couchbase &#8211; Warning Indicators</h2>
<h3>Cluster-wide metrics</h3>
#for $counter in sorted($indicator_warn)
#set $warn_list = $indicator_warn[$counter]
#for $warn_values in $warn_list
<p class="p0"><span class="ft3">$warn_values["description"]</span></p>
<ul>
	<li>Symptom
#for $warn_val in sorted($warn_values["value"])
    <ul>
      <li>Bucket : $warn_values["bucket"] , Node : $warn_val["node"]</li>
      <li>Value : $warn_val["value"]</li>
    </ul>
#end for
  </li>
  <li>Causes - $warn_values["cause"]</li>
  <li>Impact - $warn_values["impact"]</li>
  <li>Action - $warn_values["action"]</li>
</ul>
#end for
#end for
</article>
#end if
</div>
</body>
</html>
